---
title: 交流：辨析 DataFrame 几种切片_20240607210130
authors: Ethan Lin
year: 2024-06-07
tags:
  - 类型/笔记
  - 日期/2024-06-07
  - 类型/AI问答笔记
  - 类型/交流
  - 类型/运作
  - 运作/交流
aliases:
  - DataFrame 几种切片
---
# 辨析 DataFrame 几种切片

# 交流：辨析 DataFrame 几种切片_20240607210130




> [!attention]
> 以下由AI回答，不保证正确性！




对于一个 Pandas 变量，`df[column][1]`、`df[column].iloc[1]`、`df.loc[1,column]`这三者的区别？

`df[column][1]`，`df[column].iloc[1]` 和 `df.loc[1,column]` 都是用于访问 Pandas DataFrame 中的数据，但它们的用法和行为略有不同。

1. `df[column][1]`：这种方式首先通过列名 `column` 选择列，然后使用 Python 的标准索引操作符 `[]` 从选定的列中获取第二行的数据。这种方式可能会在某些情况下引发链式赋值警告。

2. `df[column].iloc[1]`：这种方式首先通过列名 `column` 选择列，然后使用 `iloc` 属性获取第二行的数据。`iloc` 是基于整数位置的索引，它只接受整数作为输入，所以 `1` 表示的是第二行。

3. `df.loc[1,column]`：`loc` 是基于标签的索引，它接受行标签和列标签作为输入。在这种情况下，它首先找到标签为 `1` 的行，然后在该行中找到名为 `column` 的列。如果行标签不是整数，或者不是从0开始的连续整数，那么 `loc` 和 `iloc` 的行为就会有所不同。

总的来说，`iloc` 和 `loc` 是更专业的索引方式，它们可以处理更复杂的索引情况，并且避免了链式赋值的问题。在实际使用中，推荐使用 `iloc` 和 `loc` 进行索引。

链式赋值是指在一行代码中连续进行两次或以上的索引或属性访问。在 Pandas 中，这可能会导致意外的结果，因为 Pandas 可能会返回数据的副本而不是视图。这意味着对副本的修改可能不会反映到原始 DataFrame 上。

例如，考虑以下代码：

```python
import pandas as pd

df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})
df[df['A'] > 1]['B'] = 10
```

你可能期望这段代码会将 'B' 列中对应 'A' 列大于 1 的行的值都设置为 10。但实际上，`df[df['A'] > 1]['B']` 返回的是一个新的 DataFrame 副本，所以赋值操作只影响了这个副本，而不是原始的 `df`。

如果你打印 `df`，你会发现 'B' 列的值并没有改变

```python
print(df)
```

输出：

```
   A  B
0  1  4
1  2  5
2  3  6
```

为了避免链式赋值的问题，你应该使用 `.loc` 或 `.iloc` 进行赋值操作：

```python
df.loc[df['A'] > 1, 'B'] = 10
```

这样，`df` 就会被正确地修改：

```
   A   B
0  1   4
1  2  10
2  3  10
```