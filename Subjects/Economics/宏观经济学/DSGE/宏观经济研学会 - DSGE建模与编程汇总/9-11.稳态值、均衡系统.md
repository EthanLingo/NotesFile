#类型/教程

#知识 

#资料 

#来源/转载



[[宏观经济]]

[[DSGE]]

[[DSGE方法]]









## DSGE建模与编程入门(9):稳态值问题




（今天的内容，即使不做DSGE，做回归的人也可以看到最后，也许对各位建立理论模型和基准回归方程有帮助哟，嘻嘻！）

有一些人留言问我，我的初始值是如何确定的，瞎猜吗？我最开始也是这么认为的，例如全部内生变量初始值都为0，或者1，反正就是10以下整数。但是当你run dynare的时候，你就知道了——error！最后连个结果的没有。Matlab会提醒你guess的初始值太差。因此，我在做论文时，其实都是直接把稳态值先求出来，再来run dynare。

问题又来了！对于steady-statevalue的计算，个人觉得是整个dsge中计算部分最麻烦的，dynare对稳态值非常敏感，稍微guess的不对，dynare就error。目前经验来看，分三类：

（1）小型模型，及可以手算的稳态值，模型如果不复杂，可以自己手动解方程组的解析解，然后代入参数值；

（2）中型模型，只能手动解出部分内生变量稳态表达式，然后剩余二维（二元）非线性方程组，可利用matlab的fsolve命令来编写简单程序解出其他稳态值；

（3）大型模型，手动几乎不可能解出任何稳态时，就要对matlab的非线性方程组解法编程十分熟悉，几种插值法，然后用电脑得出approximation value。

今天的推文就从第一类，手解方程组。其实，就算是一个简单的DSGE模型的均衡系统放在我们面前，解起来也是非常复杂的，尤其是对于人文社科出生的经济研究者（其实，我指的是本科没有好好学习基础数学知识的那些人。对于经济学方向的学生来说，也不需要掌握高深的数学知识，具体建议可以去前几周推送的Sargent的数学建议。个人觉得很好！）好了，进入今天的主题：

**个人的经验来看，解稳态值的顺序，是从资本利率开始，或者消费欧拉方程开始。**

**（1****）从经验来看，从资本利率开始求解解析式最有效，因为这样消费欧拉方程稳态时，只有利率和贴现率、折旧率等参数**

**（2****）然后代进企业一阶条件，得到人均产出**

**（3****）后面的方程全部用人均产出表示，直到家庭的劳动供给方程解出劳动**

**（4****）解出有内生变量的稳态值**

 

下面，我给出一个RBC的例子。

![Image](640-20210302160028725)

第一个方程就是投资-储蓄方程，就是消费欧拉方程；第二个方程是劳动供给方程；第三个是资本运动方程；第四个生产率冲击；第五个是生产函数；第六个是市场出清条件；第七个是债务方程；第八个是工资方程；第九个是资本利率方程。九个方程九个内生变量分别为消费C，生产率A，资本K，劳动N，产出Y，投资I，资本利率R，债券利率r，工资率w。这里有一点需要注意：债券在最后的均衡方程中没有列出，这是因为债券数量未定，且对最后的均衡结果无影响，这可以参见Modigliani and Miller：“The cost of capital，corporation finance，and the theory of investment”，AER，1958。

为了简化，我们给出效应函数![Image](640-20210302160028760)，![Image](640-20210302160028757.png)![Image](640-20210302160028754)，生产函数为![Image](640-20210302160028762)。

稳态时，A*=1，即非随机无条件均值。K（t+1）=k（t）=K*，C（t+1）=C（t）=C*。看看上面的步骤，我们最容易解出的方程，就是从消费欧拉方程开始：

（1）将稳态变量都代入其中，可以消掉稳态消费变量，得到

![Image](640-20210302160028768)

（2）那么，由上式就可以得到资本劳动比率：将所有的参数值都放到等号一边

![Image](640-20210302160028793.png)

（3）从第二步中的资本劳动比率，代入要素价格方程中，我们可以很容易得到三种价格变量

![Image](640-20210302160028826.png)

（4）由资本积累方程，我们可以得到：

![Image](640-20210302160028797.png)

（5）将上式代入市场出清条件，得到

![Image](640-20210302160028812)

（6）将上式两边同时除以稳态劳动，得到稳态人均消费

![Image](640-20210302160028842)

好了，到这一步，先把上述求解结果放一下。

（7）我们将目光转向劳动供给方程，也就是消费和闲暇的替代关系。将效用函数和生产函数都代入其中，我们可以得到

![Image](640-20210302160028799)

（8）将上述的消费移到等号左边，劳动移到右边。然后，两边同时除以劳动，得到稳态人均消费：

![Image](640-20210302160028840.png)

将第（8）步中的人均消费和第（6）步中人均消费联立起来，

![Image](http://mmbiz.qpic.cn/mmbiz_png/QA2ILNosZr4mTpKeTsO9KKFxnTiacO1Q8TQpKlVhYcNOKdoZjbxJ9p6DXfdmAWeibZCnz34MLVC3ZEwRMsGcwFNw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

（9）解出稳态劳动：

![Image](640-20210302160028835)

现在我们知道了稳态劳动，那么，我们可以将稳态劳动代回到第（2）步中，解出稳态资本存量。同理，我们知道资本-劳动比率之后，可以求出上述步骤中的其他内生变量，例如，我们可以很容易的计算出投资，产出，消费等：

![Image](640-20210302160028854.png)
![Image](640-20210302160028873.png)
![Image](640-20210302160028875)



最后，可以写出所有内生变量的解析式，即左边为内生变量，右边全部为参数，将参数值代入解析式，就可以求出内生变量稳态值。***如果有心的人可以知道，这不仅对于DSGE有用，理论模型解出解析式，就可以得到各种参数变化对内生变量的影响（就是参数变化的模拟），就可以得到各种propositions，以便在经验实证中检验，或者经验实证中的回归方程的基准方程。***

 

可是，这是针对那些可以手动解的系统，还有一些可能最后根本不可能解出内生变量的解析式。这时候，我们可能就要借助各种软件程序来解方程组（线性和非线性）。我在学习过程中，自己编写了一个fsolver code，可以让matlab解出一些稍微复杂点的方程组的稳态值。下周我们推送这个matlab code。然后，下下周就给出一些matlab修图code，主要是脉冲响应图，经常觉得别人做的好看，自己做的既单调又丑陋的时候。





## DSGE建模与编程入门(10)：稳态值问题二



稳态值问题真是个老大难，其实我也没有解决完！我们为了偷个懒，还要去当程序猿！不过话说回来，创新的动力就是人为了偷懒（亚当.斯密，1776），哈哈。今天就继续我们的稳态求解吧！

今天这个note主要写两个内容：一是简单的稳态值求解matlab程序；二是脉冲图叠加程序。

（一）稳态值matlab程序

上周，我给出了手解简单DSGE均衡系统稳态值的步骤。这类模型基本都是最基础的DSGE模型，但是我们常常在论文里（尤其是现在的论文里）看到的模型，可能大部分都不能用手解出来，或者只能解出一部分。今天所要遇到的模型就是不可能完全用手动解出来稳态值，即模型中的部分方程可以利用上周的步骤解出一部分内生变量的表达式，然后将其代入到剩余的方程中，带入之后，我们就晕了，是一个及其复杂的非线性方程或者方程组（我们知道，即使是单变量线性方程，求根公式也只到四次方程，那么，对于非线性或者高次，手动基本无解）。这个时候我们要借助一些软件程序，这里当然是matlab。其它软件程序请自学，因为我也不会，嘻嘻。

下面，给出我的另一篇文章的程序作为例子。（如引用或参考或对你做文章由班长，请脚注感谢我一下下，谢谢！嘻嘻！）

我这篇文章的初始题目是《中国采取哪种减排措施更好？——市场减排机制还是政府减排机制》，不知道是不是在MPRA作为工作论文挂出来了。

**稳态值求解matlab****程序**



```matlab
% 各参数已赋值，此处只列出基准情形稳态值的matlab程序。
>>A=1
>>R=1/beta-(1-delta)
>>e=(tua*miu/(phi1*phi2))^(1/(phi2-1))
 
% 下面需要创建一个.M文件，命名为whu.m保存
function F=whu(x)
F=[(1-eta)*x(1)-(1-e)*miu*(1-gamma1-gamma2*x(1)-gamma3*x(1)^2)*x(2)^(alpha);
R-(1-tua*(1-e)*miu-phi1*e^(phi2))*alpha*(1-gamma1-gamma2*x(1)-gamma3*x(1)^2)*x(2)^(alpha-1)];
% 建立非线性方程组函数，本文中为均衡条件中的资本一阶条件和环境演化方程所组成的非线性方程组，其中x（1）表示X，x（2）表示K。
 
>>fun=@whu;     % 然后调用这个函数
>>x0=[200,50];   %赋初值
>>x=fsolve(fun,x0)   %调用matlab的fsolve算法来解上述非线性方程组
 
%下面求解各内生变量稳态值
>>Y=(1-gamma1-gamma2*x(1)-gamma3*x(1)^2)*x(2)^(alpha)
>>Z=(1-e)*miu*Y
>>HC=phi1*e^phi2    %HC表示减排成本
>>ET=tua*Z
>>I=sigma*x(2)    %X(2)表示K
>>G=fi*Y
>>C=Y-G-I-HC
```



我这篇文章属于环境宏观经济学领域的文章（我已经在人大经济论坛上解读了很多了）。我在生产端引入了污染对生产率的负外部性（机制一），负外部性本身是一个二次多项式，然后乘以生产函数，最后解出来的式子完全无法用手算。



（二）脉冲响应图

Dynare默认输出的图是这样的：

![Image](640-20210302160155506)

当每个内生变量都只与一种冲击的时候，默认图没有什么问题。但是当有多中冲击或者多种情形时，要比较不同情形下，每个内生变量的脉冲响应，每个冲击一个图就显然不太方便。此时，我们希望将不同的线条放在同一张图里，如下图：



![Image](640-20210302160155528)
仍然给出我论文中的例子。

**图像程序方法：**



```matlab
>>load('baseline_results.mat')     %baseline_results.mat是dynare输出的结果文件名，此处就是下载这些结果数据，下同
%我的文章中有三种情形：baseline，private，public，所以下面要命名三种产出变量：outputb，output，outputp
>> outputb=oo_.irfs   % oo_.irfs是dynare输出的脉冲响应结果，下同
>>load('private_results.mat')
>> output=oo_.irfs
>>load('public_results.mat')
>> outputp=oo_.irfs
>> t=[1 2 3 4 5 6 7 8 910 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 3536 37 38 39 40 41 42 43 44 45 46 47 48 49 50]';  % 脉冲时期向量
>> subplot(3,4,1);  %  subplot是matlab中一图中包含多个子图的命令，括号中的3表示行数，4表示列数，1表示从左至右，从上至下的第一个子图
>>plot(t,outputb.y_e_a,'-k',t,output.y_e_a,'--k',t,outputp.y_e_a,':k')    %plot是二维图的命令，在这个子图中包含三条线，分别是上述三种情形下。第一条线是outputb.y_e_a，其中outputb是对基准情形脉冲响应结果的命名，后接“.”，y_e_a表示产出对生产率冲击e_a的脉冲响应，'-k'表示线型，此处一定要用英文单引号。后面的类似。
>> title('产出');      % 子图的标题，英文单引号加你得标题
>> legend('基准情形','市场机制','政府机制');     % 图例，即每种线型表示的情形。下面的解释同上。
>> subplot(3,4,2);
>> plot(t,outputb.z_e_a,'-k',t,output.z_e_a,'--k',t,outputp.z_e_a,':k')
>> title('CO2排放量');
>> subplot(3,4,3);
>>plot(t,outputb.x_e_a,'-k',t,output.x_e_a,'--k',t,outputp.x_e_a,':k')
>> title('CO2存量');
>> subplot(3,4,4);
>>plot(t,outputb.e_e_a,'-k',t,output.e_e_a,'--k',t,outputp.e_e_a,':k')
>> title('减排努力');
>> subplot(3,4,5);
>>plot(t,outputb.hc_e_a,'-k',t,output.hc_e_a,'--k',t,outputp.hc_e_a,':k')
>> title('减排成本');
>> subplot(3,4,6);
>>plot(t,outputb.c_e_a,'-k',t,output.c_e_a,'--k',t,outputp.c_e_a,':k')
>> title('消费');
>> subplot(3,4,7);
>>plot(t,outputb.k_e_a,'-k',t,output.k_e_a,'--k',t,outputp.k_e_a,':k')
>> title('资本存量');
>> subplot(3,4,8);
>>plot(t,outputb.i_e_a,'-k',t,output.i_e_a,'--k',t,outputp.i_e_a,':k')
>> title('投资');
>> subplot(3,4,9);
>> plot(t,outputb.r_e_a,'-k',t,output.r_e_a,'--k',t,outputp.r_e_a,':k')
>> title('利率');
>> subplot(3,4,10);
>>plot(t,outputb.et_e_a,'-k',t,output.et_e_a,'--k',t,outputp.et_e_a,':k')
>> title('环境税收');
>> subplot(3,4,11);
>>plot(t,outputb.g_e_a,'-k',t,output.g_e_a,'--k',t,outputp.g_e_a,':k')
>> title('财政支出');
>> subplot(3,4,12);
>>plot(t,outputb.a_e_a,'-k',t,output.a_e_a,'--k',t,outputp.a_e_a,':k')
>>title('生产率');
```



如果对更多、更复杂（非）线性方程组解法感兴趣，可以去参考：

*1、任玉杰，数值分析及其MATLAB实现，高等教育出版社。*

*2、M. J. Miranda & P. L. Fackler, Applied Computational Economics and Finance, The MIT Press.*

*3、P. Brandimarte, Numerical methods in finance and economics : a MATLAB-based introduction, John Wiley & Sons, Inc.*

*4、K. L. Judd, Numerical Methods in Economics, The MIT Press.*

*5、other Judd's essays and notes.*

*
*

*如各位有更好的方法，或者更好的程序，希望能共享！非常非常感谢！*



## DSGE建模与编程入门(11)：均衡系统



昨天做了两场Presentation，两篇paper，喉咙很痛。头也晕乎乎的，像缺氧了！所以昨晚并没有专心准备一个完整的DSGE模型给大家，请大家见谅！



不过，昨天跟东财、华东师大等高校的博士进行了一场微信群研讨会，报告了自己的一篇paper，然后跟大家讨论交流了一下，收获很大！所以如果大家有兴趣，可以拿出自己的paper（不一定是DSGE），我们可以不定期在线上组织研讨交流！欢迎大家来报告和参与讨论！如有兴趣，给我留言即可！



本学期也还剩下几个完整的DSGE实例展示——RBC和NK，用于处理财政政策或者货币政策问题。今天就给大家推送一些建模过程中的注意事项。



***DSGE内生变量与均衡方程数量不对应问题***

两种可能：

1、你多算了内生变量，例如，在有政府债券的model中，我们可能经常会把政府债券也算进去却没有给它稳态值，一般情况下，家庭持有的债券和政府供给在的债券在问题时为0，因此，一般是不用将其包含在最后的均衡系统中（MM定理，参见Modigliani and Miller，1958，AER）；

2、如果最后的内生变量个数没错，那么，列均衡方程的原则（或办法）或者步骤：

（1）列出所有的资源约束条件、一阶条件、总和条件及冲击

（2）第一步做完，肯定方程多了，这是由于一阶条件和总和条件是由目标函数和约束条件推导得到的，例如，A和B得到C，那么，A\B\C中只需要两个即可。

















