#类型/教程

#知识 

#资料 

#来源/转载



[[宏观经济]]

[[DSGE]]

[[DSGE方法]]

[[线性化]]






## DSGE建模与编程入门（6）：线性化技术

Original 许文立 宏观经济研学会 *2016-10-09*

收录于话题

\#DSGE建模与编程

125个

![img](640-20210302155852910)

许文立

（武汉大学财税系，xuweny87@163.com，环境政策、财政政策与经济增长）



Dynare现在可以不用线性化做simulation，因此，我好像已经好长时间没有自己动手做过线性化了。国庆期间，自己手痒，试了试最近写的一篇workingpaper，惊奇地发现居然不会了（当然，手生了嘛，电脑用多了，汉字都不会写了，哈哈），好尴尬呀。然后，拿出我的“法宝”，哐哐当当做出来了（哈哈）。有时候看见一些中文文章的正文里，噼里啪啦一大推线性化过程，本来前面的一大堆外星文似的equilibrium condition就把人搞晕了，又来这么多带bar的equations。我记得第一次看到一篇文章的时候，在想：“中文期刊不是限制版面吗？怎么还能写这么多。后来又想，原来不公布附录，没地方放呀！”（目前为止，我的workingpaper中的推导过程和coding基本都公布）。因此，今天就回顾一下equilibrium system的线性化技术吧，今天公式可能有点多，但是都非常简单，晕公式的一定要耐心点看。本来今天要进入Dynare编程阶段的，只有让急切的人儿们再耐心的等待一周啦，嘻嘻！





第一节对数线性化概述

我们在面对动态宏观经济学的时候，经常会遇到非线性差分方程系统的求解问题。这就要求我们利用数值型或者近似的方法来解决这类问题。

最常用的方法是对数线性化。首先，对非线性差分方程取对数。然后，线性化这些对数差分方程。通常，上述线性化会利用泰勒展开，而动态宏观经济学中一般都是在稳态点附近进行展开。

对于任意一个函数![Image](640-20210302155852888.png)为稳态，泰勒展开公式为

![Image](640-20210302155852887)

对于一个足够平滑的函数来说，高阶导数非常小，因此在稳态附近，函数可近似为

![Image](640-20210302155852887.png)

同理，对于二元函数![Image](640-20210302155852889.png)，在稳态![Image](640-20210302155852888)附近的一阶泰勒展开式为

![Image](http://mmbiz.qpic.cn/mmbiz_png/QA2ILNosZr4hhia5ZeDIpYEApKboAwlLpdicMnoadP5FMTOAKy6wKtvNAtk0Lpibic22nBaNciblKBKdFgwXJZnl5ZA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

对于非线性函数![Image](640-20210302155852924)，首先，两边取对数得到

![Image](640-20210302155852925.png)

然后，分别对![Image](640-20210302155852926)线性化

![Image](640-20210302155852930)

所以

![Image](640-20210302155852970)

设![Image](640-20210302155852959.png)，则

![Image](640-20210302155852962.png)

综上所述，非线性函数对数线性化的步骤一般为

（1）取对数

（2）在特定点处，一阶泰勒展开

（3）化简，将展开式中的表达式表达成偏离程度（或者偏离百分比）

例1 **科布****-****道格拉斯（****Cobb-Douglas****）生产函数**

我们考虑一个规模报酬不变的C-D函数，形式如下：

![Image](640-20210302155853125)

其中，Y是产量，A是全要素生产率，K是资本存量，L是劳动，t表示时期。

按照上述步骤，首先对C-D生产函数两边取对数得到

![Image](640-20210302155852967.png)

然后，将等式（1）两边在其稳态值处一阶泰勒展开

![Image](640-20210302155852964)

因此，可以得到

![Image](640-20210302155853002)

由![Image](640-20210302155852998.png)，可得到

![Image](640-20210302155853006.png)

将上式表达成偏差形式，则为

![Image](640-20210302155853015)

经济学中常见的例子还有核算恒等式、资本积累方程以及消费欧拉方程等，你们按照上述步骤练习对数线性化。

从上面的非线性方程对数线性化过程可以看出，函数形式较为简洁时，上述方法较为适用。如果函数形式较为复杂，可能要借助另外一些方法。

 

 

 

第二节 全微分法

首先，我们来回忆一下全微分的概念。

函数![Image](640-20210302155853032.png)的导数![Image](640-20210302155853047)与自变量x的增量![Image](640-20210302155853056.png)的乘积为

![Image](640-20210302155853062)

而函数![Image](640-20210302155853052)的全增量为

![Image](640-20210302155853075)

因此，![Image](640-20210302155853089.png)是![Image](640-20210302155853089)时的高阶无穷小量。

那么，![Image](640-20210302155853118)称为函数![Image](640-20210302155853103.png)在x处的全微分。当变量是连续性时，![Image](http://mmbiz.qpic.cn/mmbiz_png/QA2ILNosZr4hhia5ZeDIpYEApKboAwlLpgR4m1kS5Aultzr2RhrT2EkG1VWkGJKJSUQfNgZw9YHXuicamO8zJW1A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)分别可用![Image](640-20210302155853120)表示，即![Image](http://mmbiz.qpic.cn/mmbiz_png/QA2ILNosZr4hhia5ZeDIpYEApKboAwlLpVe1RY0nwPPSSUI7JIGcuMr607AGWQur2Gr0WZSHZyazcxXF1frDOzQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)。

因此，我们可以用![Image](640-20210302155853161.png)表示上一节中的![Image](640-20210302155853164-4671933.png)。本节接下来的内容将用Gali和Monacelli（2005）的论文作为例子进行阐述。我们利用Gali和Monacelli（2005）论文中的方程组（6）来进行演示说明，其方程组形式如下

![Image](640-20210302155853161)

其中，Ct是总消费量；CHt国内商品消费量；CFt是国外商品消费量；PHt是国内商品价格；PFt是国外商品价格；Pt是总价格水平。上式表示对国内商品和国外商品的最优消费配置。

对第一个方程两边取对数，得到

![Image](640-20210302155853161-4671933.)

利用全微分的定义，对上述等式两边的每一项在其稳态值附近取全微分，得到

![Image](640-20210302155853164.png)

其中，![Image](640-20210302155853537)分别为对应变量的稳态值。

设![Image](640-20210302155853206.png)，由![Image](640-20210302155853182)可知，![Image](640-20210302155853192)，那么，我们就能将上述全微分方程形式写成如下形式

![Image](640-20210302155853209.png)

上式即为国内商品消费方程的线性化形式。

同理，可以求得国外商品消费方程的线性化形式。首先，对方程两边取对数，得到

![Image](640-20210302155853199.png)

然后，对上述对数方程两边的每一项，在其稳态附近取全微分形式，得到

![Image](640-20210302155853224.png)

其中，![Image](640-20210302155853227.png)分别为对应变量的稳态值。

最后，将全微分形式的方程转换成线性化方程形式，得到

![Image](640-20210302155853239)

上式即为国外商品消费方程的线性化形式。

从上述全微分线性化过程来看，与上一节的一阶泰勒展开方法相比，线性化过程更简洁、更快速，且线性化的方程系统也以稳态偏离形式呈现出来。虽然，一阶泰勒展开的对数线性化方法与全微分对数线性化方法都是用于非线性方程的线性化，但是，全微分对数线性化方法更为简单，因此，相对于一阶泰勒展开，全微分方法在实际论文写作中更为流行。

 

 

 

第三节 Uhlig法

H.Uhlig（1999）提出了一种更为简单的对数线性化方法。他的方法不需要求导，并且其线性化模型也是以对数偏离形式呈现出来。

Uhlig（1999）方法的核心思想为：

考虑一个对数偏离形式

![Image](640-20210302155853242)

其中，X为稳态值，![Image](640-20210302155853243.png)为对数偏离值。

对上式两边取指数形式，得到

![Image](640-20210302155853256.png)（大家千万要记住这个，这个替换非常重要，非常重要，非常重要！）

那么，Uhlig（1999）的方法就十分简单，将所有变量都利用上述变换代替，并使用下述展开规则：

![Image](640-20210302155853264.png)

上述展开规则均使用一阶泰勒展开。

值得注意的是，对于Jensen不等式

![Image](640-20210302155853282)

因为，自然对数函数是严格凹函数，因此，上述不等式总是成立。那么，我们就不能简单的对带有期望算子的函数取对数（在equilibrium中，哪有不带期望的，所以这个方法是我的最爱！），而Uhlig（1999）的方法不受Jensen不等式的束缚。

我们仍然使用Gali和Monacelli（2005）论文中的方程作为例子进行说明。GM（2005）的论文中的方程（10），即消费欧拉方程为

![Image](640-20210302155853277.png)

为了方便处理，我们设

![Image](640-20210302155853310)

那么，上式就可以转换为

![Image](640-20210302155853322.png)

利用Ulihg（1999）的变换方法，将上式中的每一个变量都用其稳态乘以指数的形式替换，得到

![Image](640-20210302155853636)

利用其静态条件

![Image](640-20210302155853312)

那么，上述指数形式就可以变换为

![Image](640-20210302155853325.png)

利用上述展开规则，得到

![Image](640-20210302155853318)

这一步已经得到线性化形式。但是，其中包含的和并不是我们所关心的变量。根据前文的定义

![Image](640-20210302155853372.png)

对上述定义式两边去对数，得到

![Image](640-20210302155853353)

两边去全微分形式

![Image](640-20210302155853357)

因此，

![Image](640-20210302155853361)

将其代入式（1）中，变形得到

![Image](640-20210302155853385)

 

第四节替代法

严格来讲，替代法并不是线性化非线性方程的一种正式方法，我们可以将其看作是上述线性化方法的补充方法。在一些情况下，直接利用上述方法也会存在一定的困难，因此，我们需要将方程中相关表达式进行一定变换，例如，在上一节的Uhlig法中，我们设![Image](640-20210302155853395)，本节的替代法类似于此。下面，我也通过一个例子来进行相关的阐述。

看看下面的非线性方程

![Image](640-20210302155853393.png)

对上式两边取对数，得到

![Image](640-20210302155853407)

那么，上式的稳态条件即为

![Image](640-20210302155853421.png)

两式相减，得到

![Image](640-20210302155853426)

则，上式得对数偏差形式为

![Image](640-20210302155853564.png)

但是，上式的对数偏差形式中有![Image](640-20210302155853460.png)，我们关心的是变量![Image](640-20210302155853441.png)的对数偏差![Image](640-20210302155853581)。我们回忆一下，

![Image](640-20210302155853582)

那么，

![Image](640-20210302155853580-4671933.)

上面两个式子中，等式右边的分子相同，因此，我们对上式进行适当变换，得到

![Image](640-20210302155853580)

则

![Image](640-20210302155853688)

将上式代到式（1）中，得到

![Image](640-20210302155853602)

上式就是我们最终要知道的线性化方程。



***总结技巧：（1）如果equations全部是乘除法或者指数或者它们的组合形式，可以直接对方程两边取对数，这样就可以化简为线性形式，然后求导，做变量替代，得到最好的线性化形式；***

***（2）最直观就是方法就是Uhlig法，不管什么形式的equations，把所有变量都用指数形式![Image](640-20210302155853256.png)替代，然后利用指数近似![Image](640-20210302155853619)，转换为线性形式；
***

***（3）从上面的例子，也看出来，有些时候需要利用其它方法（替代法）来配合Uhlig法，这种情况就是，equations中包含加减乘除混合运算的时候。尤其是，变量与常数加减的时候，经常要用替代法。***

***（4）本系列是一个入门级notes，主要针对没有学过甚至没有接触过高宏和DSGE，有上进心的人，所以在于了解。如需要更深入学习，推荐本人9月27日推送的《DSGE学习进阶及其推荐书目、网站》。最重要最重要的是，看经典看经典看经典（很多大牛都这么教我的！在此就不一一致谢了！嘻嘻）。***

***（5）最近，国际上，尤其是诺奖级的大牛们对DSGE的争论非常热烈，国内似乎有点平静，可能还是国内对于这一领域感兴趣的学人不多。因此，我一直坚持写notes的最重要原因之一就是希望有更多的人，尤其是硕博士们（或者与我一样的年轻人）能加入到这一领域的研究中来，再次引用毛爷爷的话：“人多力量大！”***