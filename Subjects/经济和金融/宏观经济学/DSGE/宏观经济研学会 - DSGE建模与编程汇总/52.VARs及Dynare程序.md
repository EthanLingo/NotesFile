#类型/教程

#知识 

#资料 

#来源/转载



[[宏观经济]]

[[DSGE]]

[[DSGE方法]]



许文立，安徽大学经济学院/CIMERS，cimers_dsge@econmod.cn



更多信息和读者交流请参见我们的“量化经济分析平台论坛”（http://www.econmod.cn:999/forum.php，点击***阅读原文\***查看），可以提问交流！

![Image](640-20210302160931896)



好了，我们回到这一期“DSGE建模与编程入门”的主题——VAR模型及其Dynare编程（历史合集请看：[DSGE建模与编程汇总](http://mp.weixin.qq.com/s?__biz=MzAwODY5MDA3NA==&mid=2455729030&idx=1&sn=254a8c1e359b242660dc9e405485fce3&chksm=8cc0d373bbb75a6502c892a49c84a71b6aa5caf6ff7eb6b415579ffdefcc9fc6f81d810387de&scene=21#wechat_redirect)）。许坤博士曾多次介绍过VAR类模型的R程序与结果（参见：[R、Python语言与编程汇总](http://mp.weixin.qq.com/s?__biz=MzAwODY5MDA3NA==&mid=2455729030&idx=2&sn=c9b52cc20548e11ec6bb104c5ecb98db&chksm=8cc0d373bbb75a65ae19965fe5a2b384fdbf19cf6251ea6747c40fb4fff0c6c88b85a7e62ce1&scene=21#wechat_redirect)）。但是，许坤博士的推文并没有介绍VAR模型的基本原理。今天我就给大家介绍一下VAR模型和Dynare程序。

写VAR的原因有二：

1、上周在北京讲授DSGE时，发现大家普遍不重视VARs模型的结合。在目前高质量的宏观经济研究中，学者一般都会用VARs模型来提出自己想要解释的特征事实（研究问题），而DSGE则从经济理论更好的讲出这个故事（清晰地揭示传导机制）。因此，VARs与DSGE模型的结合十分重要。

2、许多计量老师都是研究微观经济领域，对回归分析等缩减形式（reduced form）的因果估计与识别十分在行，但正是这种在行（思维定势）让他们在讲授宏观经济研究方法（例如VAR）时，往往只关注于缩减形式，而这又会让初学者难以理解VARs的识别问题。



宏观经济领域的研究方法主要分为两大类：VARs和DSGEs。DSGE模型我们已经介绍很多了，而VARs的理论则涉及较少。看过我们推送的[宏观经济预测(1)：概述与文献回顾](http://mp.weixin.qq.com/s?__biz=MzAwODY5MDA3NA==&mid=2455728180&idx=1&sn=a667cd0d115326697a2f4728a754c0c8&chksm=8cc0d0c1bbb759d7fae4de04c5458bd0130f10bc005e67668ade5d135630d6f34acb265d347b&scene=21#wechat_redirect)的同仁可能有印象，VAR类模型有十几个变种，而且这些模型在国内外主流期刊上都可以单独成发文。更为重要的是，Sims在2010年因它而获得诺贝尔经济学奖。



Sims对许多领域都做出过突出贡献，而其最重要的贡献之一就是向量自回归——VAR（例如，“Macroeconomics and Reality,” *Econometrica*，1980）。利用VAR模型，可以说明政策的效应。例如，当央行降低利率，我们可以利用VAR类模型来模拟该政策变化对宏观经济的动态影响路径。在VAR模型的参数估计中，Sims主要使用Bayesian估计，且为了估计出参数，也需要对VAR施加许多识别限制。



一、VAR模型

我们现在对产出xt和消费zt之间的相互影响感兴趣。而且，x和z之间存在同期相互影响和滞后一期相互影响。假设为线性关系，那么，我们可以将产出x和消费z之间的关系建模为

![Image](640-20210302160932030.png)

如果学过计量应该知道，我们现在的问题是，不能直接一致性地估计上述方程的参数，因为产出xt和消费zt都是内生变量。我们可以来看看在第二个方程中，zt依赖于xt，而xt在第一个方程中依赖于sxt，因此，zt就间接地依赖于sxt。同理，xt也间接地依赖于szt。因此，用OLS估计的所有参数都是不一致的。而用极大似然（ML）估计可能也不能解决这个问题，因为这并不是一个估计（estimation）问题，而是一个识别（identification）问题。



我们将上式转换为t期变量是前定变量和同期误差项的函数，即

![Image](640-20210302160932035.png)

将上式化简为

![Image](640-20210302160931970)

此时，我们可以明显看出，参数β并不是自由参数，而是深度参数δ、μ的函数，即***β=f(δ,μ)\***。同理，此处的误差项r也不是自由变量，而是由根本性误差项（冲击，fundamental shocks）组成的函数，即

![Image](640-20210302160932006.png)

与模型（1）比较，（2）中的xt-1和zt-1只与rzt-1和rxt-1间接关联，因此，OLS可以得到一致估计。



方程（1）为模型的***结构表达式（structural representation）\***，而方程（2）则为模型的***缩减形式表达式（reduced form representation）\***。

**注意：（1）**缩减形式的模型只需要估计4个参数，而结构模型则需要估计6个参数。（2）可能有人会疑惑，那用缩减形式的估计，是不是会遗漏同期相关变量呢？不会，因为虽然我们认为xt是zt的一个重要组成部分，但是估计zt的参数，而遗漏xt并不是遗漏变量的来源，我们估计的是原方程的一种变形。



我们还可以将模型（2）以向量的形式表达出来

![Image](640-20210302160932013.png)

yt=[xt,zt]'，B_=[βi]，rt=[rxt,rzt]'。上式（3）就是缩减形式的VAR模型，我们此处只考察了滞后一期，因此，为VAR(1)。



结构模型则可以写成

![Image](640-20210302160932007)

因此，结构形式与缩减形式的根本性差异表现在***结构冲击st是否出现在模型中\***。很显然，

![Image](640-20210302160932006)

也就是说，缩减形式冲击rt源自于根本性的结构性冲击st。而VAR模型的平稳条件则是矩阵B_的最大特征值在单位元内。



二、VAR模型的识别问题

在计量经济学中，识别是一个非常宽泛的概念。在我们的VAR模型中，识别结构模型就意味着估计出矩阵B_。



在估计的缩减形式模型（3）中，我们可以得到冲击r的方差-协方差矩阵

![Image](640-20210302160932045.png)

注意：缩减形式冲击r的方差-协方差矩阵并不是非零对角矩阵，因为冲击之间是相关的。

由（5）式，可以得到

![Image](640-20210302160932064)

其中，D是结构冲击st的真实方差-协方差矩阵。因为结构冲击彼此不相关，因此，D是一个对角矩阵。由此，很清晰地看出，方差-协方差矩阵Sigma包含三个元素，矩阵B_中有四个元素，D中有两个元素，我们只有产出xt、zt和缩减形式冲击r的方差-协方差矩阵三个信息，那么，我们不能估计出6个参数，该模型系统就没有识别，即要唯一地估计出矩阵B_，我们还需要一些其他的限制条件（额外的信息）。



更一般的情形，VAR模型中包含n个变量，那么，方差-协方差矩阵包含n(n+1)/2个元素，矩阵B包含n^2个元素，矩阵D包含n个元素。通常，我们可以将结构冲击的真实方差-协方差矩阵D标准化为单位矩阵，因此，我们可以消掉n个待估计参数，但是很遗憾，模型系统仍然识别不足。



在这个假设下，为估计矩阵B_，数据所施加的关键条件为

![Image](640-20210302160932064.png)

且在已知n(n+1)/2元素的情况下，解出n^2个未知数（n>2，n^2>n(n+1)/2）。



正是为了识别该模型，学者提出许多方法来增加额外信息（或限制）来估计B。而这些不同的方法就演变出了VAR类模型的不同变种。

***注意：\***

1、解上述模型系统的关键挑战是B的元素是非线性的；

2、有一些人根据理论来增加限制，而另一些人则从数据的统计特征中施加限制，这两种限制来源有非常大的差别；

3、识别方法划分为pointwise identification和set identification。前者是为了估计B而增加足够的、恰当的限制；而后者则增加相对较少的限制，而是给出备选B的整个集合；

4、给定n个变量的VAR模型，尝试识别所有n个结构冲击和尝试识别一部分结构冲击，这两者之间存在概念性的差异。



而识别方法有：

1、Recursive identication - Cholesky（最常用的识别机制）

2、non-recursive zero restrictions

3、符号限制Sign restrictions

4、long run restrictions（理论限制）

5、外部工具变量（Romer and Romer，2004，AER）

6、Identication through heteroskedasticity

7、Restrictions on contemporaneous independence（Herwartz，2015）



三、SVAR

VAR模型只是利用了数据的动态（dynamics），而SVAR（结构VAR）则用于估计VAR模型的结构冲击和其它统计量。那么，什么是结构冲击呢，或者我们如何理解结构冲击？



例如，货币政策冲击就是人民银行改变基准利率，而这种基准利率又是外生于经济状态的。那么，我们有时候会疑惑，人民银行之所以改变利率就是为了对一些经济状态作出响应呀。如果真是这样，那么，货币政策冲击就不复存在。



已经有大量文献讨论了为什么至少有一部分利率变动是外生的。这些讨论之一是政策利率的变动是货币政策委员会成员开会讨论的结果之一，委员会的决策过程就为政策冲击的外生性留下了空间。Romer and Romer（2004）的narrative approach就是讨论的这种外生性理解。



另一种理解来源于给定市场上的价格和数量的联合决定（jiont determination）过程。如果我们要进行结构分析，那么，我们可以将两种结构冲击理解为价格冲击和数量冲击。例如，在一个瓦尔拉斯环境下，价格的变动是依赖于需求和供给，因此，价格的变动可以分解成根本性因素的变动。同理，数量的变动的可以分解。那么，我们就可以将价格冲击和数量冲击理解成需求冲击和供给冲击。





四、Bayesian VAR（BVAR）的Dynare coding

以下内容摘自于许文立（2018）：《DSGE第一课》。如引用，请标注：

![Image](640-20210302160932098.jpeg)

![Image](640-20210302160932168.jpeg)

![Image](640-20210302160932069)

![Image](640-20210302160932134.jpeg)

![Image](640-20210302160932154.jpeg)

![Image](640-20210302160932112)

